(function(t){function e(e){for(var a,r,o=e[0],c=e[1],l=e[2],d=0,h=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&h.push(i[r][0]),i[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(h.length)h.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(a=!1)}a&&(s.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},i={app:0},s=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("c21b")},"0ae9":function(t,e,n){"use strict";n("dcb2")},5416:function(t,e,n){"use strict";n("b58d")},"56d7":function(t,e,n){"use strict";n.r(e);var a=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("notifications",{attrs:{position:"top center"}}),n("v-dialog",{staticStyle:{"z-index":"1000"}}),n("router-view")],1)},s=[],r={name:"app"},o=r,c=(n("034f"),n("2877")),l=Object(c["a"])(o,i,s,!1,null,null,null),u=l.exports,d=n("8c4f"),h=n("2f62"),m=n("0e44"),p=(n("96cf"),n("1da1")),f=n("bc3a"),v=n.n(f),b=n("1232"),g="http://84.38.188.128:3670/",C={token:null,user:null},_={isAuthenticated:function(t){return!!t.token},StateToken:function(t){return t.token},StateUser:function(t){return t.user}},k={LogIn:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e,n){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.commit,t.next=3,v.a.post("login/",JSON.stringify(Object.fromEntries(n)),{baseURL:g,headers:{"Content-Type":"application/json"}}).then(function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.data.access_token,t.next=3,a("setToken",n);case 3:return i=Object(b["a"])(n),s={id:i.Id,guidId:i.GuidId,username:i.Name,email:i.MailAddress,role:i.Role},t.next=7,a("setUser",s);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}},t)}));function e(e,n){return t.apply(this,arguments)}return e}(),LogOut:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.next=3,n("logout");case 3:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()},w={setToken:function(t,e){t.token=e},setUser:function(t,e){t.user=e},logout:function(t){t.token=null,t.user=null}},x={state:C,getters:_,actions:k,mutations:w},y=(n("ac6a"),n("7f7f"),n("7514"),n("1a9a")),$={AdvertisingClient:{stateName:"clients",baseURL:"http://84.38.188.128:3690/",path:"advertisingclient"},AdvertisingVideo:{stateName:"clientVideos",baseURL:"http://84.38.188.128:3690/",path:"advertisingvideo"},Channel:{stateName:"channels",baseURL:"http://84.38.188.128:3690/",path:"channel"},ClientChannel:{stateName:"clientChannels",baseURL:"http://84.38.188.128:3690/",path:"clientchannel"},Content:{stateName:"contents",baseURL:"http://84.38.188.128:3690/",path:"content"},ContentVideo:{stateName:"contentVideos",baseURL:"http://84.38.188.128:3690/",path:"contentvideo"},Order:{stateName:"orders",baseURL:"http://84.38.188.128:3690/",path:"order"},User:{stateName:"users",baseURL:"http://84.38.188.128:3690/",path:"user"},DeviceState:{stateName:"devices",baseURL:"http://84.38.188.128:3700/",path:"device"},DeviceTasks:{baseURL:"http://84.38.188.128:3700/",path:"device/tasks"}},O={clients:null,clientVideos:null,channels:null,clientChannels:null,contents:null,contentVideos:null,orders:null,users:null,devices:null,uploads:[]},j={clearModels:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:for(a in n=e.commit,$)n("setModels",{stateName:$[a].stateName,models:null});n("setModels",{stateName:"uploads",models:[]});case 3:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),getModels:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e,n){var a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.commit,i=$[n],t.next=4,v.a.get(i.path,{baseURL:i.baseURL,headers:{Authorization:"Bearer ".concat(this.getters.StateToken),"Content-Type":"application/json"}}).then(function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:a("setModels",{stateName:i.stateName,models:e.data});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}},t,this)}));function e(e,n){return t.apply(this,arguments)}return e}(),postModel:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e,n){var a,i,s,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.commit,a=n.model,i=n.modelName,s=n.callback,r=$[i],t.next=5,v.a.post(r.path,a,{baseURL:r.baseURL,headers:{Authorization:"Bearer ".concat(this.getters.StateToken),"Content-Type":"application/json"}}).then(function(t){s(t)}).catch(function(t){var e={status:12002,error:t};s(e)});case 5:case"end":return t.stop()}},t,this)}));function e(e,n){return t.apply(this,arguments)}return e}(),deleteModel:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e,n){var a,i,s,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.commit,a=n.model,i=n.modelName,s=n.callback,r=$[i],t.next=5,v.a.delete(r.path,{baseURL:r.baseURL,headers:{Authorization:"Bearer ".concat(this.getters.StateToken),"Content-Type":"application/json"},data:a}).then(function(t){s(t)}).catch(function(t){var e={status:12002,error:t};s(e)});case 5:case"end":return t.stop()}},t,this)}));function e(e,n){return t.apply(this,arguments)}return e}(),connectToNotifyService:function(t){var e=t.commit,n=this,a="",i=function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.start();case 3:return t.next=5,s.invoke("SetSubscriberIdAsync",n.getters.StateUser.guidId);case 5:a=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),setTimeout(i,5e3);case 11:case"end":return t.stop()}},t,null,[[0,8]])}));return function(){return t.apply(this,arguments)}}(),s=(new y["a"]).withUrl("http://84.38.188.128:3680/user").configureLogging(y["b"].Information).build(),r=!0;new Date;s.on("Notify",Object(p["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=6;break}return r=!1,t.next=4,R(n,e,$,a);case 4:new Date,r=!0;case 6:case"end":return t.stop()}},t)}))),s.onclose(i),i()},uploadLogo:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e,n){var a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.commit,a=n.logo,i=n.callback,s=new FormData,s.append("file",a),t.next=6,v.a.post("logo",s,{baseURL:"http://31.184.219.123:4000"}).then(function(t){i(t)}).catch(function(t){var e={status:12002,error:t};i(e)});case 6:case"end":return t.stop()}},t)}));function e(e,n){return t.apply(this,arguments)}return e}(),uploadVideo:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e,n){var a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.commit,a=n.video,i=n.callback,s=new FormData,s.append("file",a),t.next=6,v.a.post("video",s,{baseURL:"http://31.184.219.123:4000"}).then(function(t){i(t)}).catch(function(t){var e={status:12002,error:t};i(e)});case 6:case"end":return t.stop()}},t)}));function e(e,n){return t.apply(this,arguments)}return e}()};function R(t,e,n,a){return T.apply(this,arguments)}function T(){return T=Object(p["a"])(regeneratorRuntime.mark(function t(e,n,a,i){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v.a.get("notifications?connection=".concat(i),{baseURL:"http://84.38.188.128:3680",headers:{Authorization:"Bearer ".concat(e.getters.StateToken),"Content-Type":"application/json"}}).then(function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(i){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i.data.forEach(function(t){return M(e,t,n,a)});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}},t)})),T.apply(this,arguments)}function M(t,e,n,a){if(e.model=JSON.parse(e.model),"DiagnosticInfo"!=e.type)if("DeviceTasks"!=e.type)if("Device"!=e.type){var i=a[e.type],s=t.state.manager[i.stateName].filter(function(t){return t.id!=e.model.id});if(1==e.operation&&"ClientChannel"==e.type&&D(t,n,e.model),1==e.operation&&"AdvertisingClient"==e.type){var r=t.state.manager["clientChannels"].filter(function(t){return t.ads_client==e.model.id});r.forEach(function(e){return D(t,n,e)}),n("setModels",{stateName:"clientChannels",models:t.state.manager["clientChannels"].filter(function(t){return t.ads_client!=e.model.id})})}0==e.operation&&s.push(e.model),n("setModels",{stateName:i.stateName,models:s})}else{var o=t.state.manager["devices"].find(function(t){return t.id==e.model.id});void 0!=o&&(o.name=e.model.name,o.address=e.model.address,o.latitude=e.model.latitude,o.longitude=e.model.longitude,o.last_online=e.model.last_online,o.account=e.model.account,o.channel=e.model.channel)}else{var c=t.state.manager["devices"].find(function(t){return t.id==e.model.id});void 0!=c&&(c.tasks=e.model)}else{"11111111-1111-1111-1111-111111111111"==e.model.Id&&console.log(e);var l=t.state.manager["devices"].find(function(t){return t.id==e.model.Id});void 0!=l&&(l.info=e.model)}}function D(t,e,n){e("setModels",{stateName:"orders",models:t.state.manager["orders"].filter(function(t){return t.ads_client_channel!=n.id})})}var V={setModels:function(t,e){var n=e.stateName,a=e.models;t[n]=a}},S={state:O,actions:j,mutations:V};a["default"].use(h["a"]);var N=new h["a"].Store({modules:{auth:x,manager:S},plugins:[Object(m["a"])()]}),L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("div",{staticClass:"container-fluid pt-3 pb-3"},[n("ControlPanel"),n("div",{staticClass:"row mt-3"},[n("div",{staticClass:"col-md"},[n("AccountPanel"),n("InformationPanel")],1),n("div",{staticClass:"col-md"},[n("b-icon-plus",{staticClass:"card plus mb-1",attrs:{"font-scale":"5"},on:{click:t.addChannel}}),t._l(t.channels,function(e){return n("ChannelCard",{key:e.id,attrs:{channel:e,editCallback:t.editChannel,deleteCallback:t.deleteChannel}})})],2)])],1)])},E=[],F=n("5530"),U=(n("55dd"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card rounded",attrs:{id:"control-panel"}},[n("div",{staticClass:"card-body text-center text-uppercase"},[n("h1",[t._v(t._s(t.Title))])])])}),A=[],P={name:"control-panel",data:function(){return{Title:"Панель управления"}}},I=P,H=(n("5416"),Object(c["a"])(I,U,A,!1,null,"76f26bda",null)),Y=H.exports,z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card",attrs:{id:"account-panel"}},[n("div",{staticClass:"card-body text-center"},[n("h2",{staticClass:"card-title text-uppercase text-muted"},[t._v("текущее время")]),n("h1",{staticClass:"card-text",attrs:{id:"current-time"}},[t._v(t._s(t.time))]),n("div",{staticClass:"card-body text-center mt-2"},[n("h2",{staticClass:"card-title text-uppercase text-muted"},[t._v("учетная запись:")]),n("h3",{staticClass:"card-text"},[t._v("Логин: "+t._s(this.$store.getters.StateUser.username))]),n("h3",{staticClass:"card-text"},[t._v("Email: "+t._s(this.$store.getters.StateUser.email))]),"User"==this.$store.getters.StateUser.role?n("button",{staticClass:"btn btn-outline-success ajax-all-workers ml-2 mt-2",attrs:{href:"../control_panel/workers/"}},[t._v("Работники")]):t._e(),"User"==this.$store.getters.StateUser.role?n("button",{staticClass:"btn btn-outline-primary ajax-all-content ml-2 mt-2",attrs:{href:"../control_panel/contents/"},on:{click:t.showContents}},[t._v("Альтернативный контент")]):t._e(),n("button",{staticClass:"btn btn-outline-primary ajax-all-clients ml-2 mt-2",attrs:{href:"../control_panel/clients/"},on:{click:t.showClients}},[t._v("Клиенты")]),n("button",{staticClass:"btn btn-outline-primary ajax-all-devices ml-2 mt-2",attrs:{href:"../control_panel/devices/"},on:{click:t.showDevices}},[t._v("Приставки")]),n("button",{staticClass:"btn btn-outline-warning ml-2 mt-2"},[t._v("Изменить пароль")]),n("button",{staticClass:"btn btn-outline-warning ml-2 mt-2"},[t._v("Изменить Email")]),n("button",{staticClass:"btn btn-outline-danger ml-2 mt-2",on:{click:t.logout}},[t._v("Выйти")])])])])},B=[],J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},[n("b-icon-plus",{staticClass:"card plus mb-1",attrs:{"font-scale":"5"},on:{click:t.addContent}}),t._l(t.contents,function(e){return n("ContentCard",{key:e.id,attrs:{content:e,clickCallback:t.showContentVideos,editCallback:t.editContent,deleteCallback:t.deleteContent}})})],2)},q=[],G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card p-2 mb-0 mt-1"},[n("div",{staticClass:"align-items-center pt-2 pr-2 pl-2"},[t.deleteCallback?n("button",{staticClass:"close float-right",attrs:{type:"button"}},[n("b-icon-x",{attrs:{variant:"danger"},on:{click:function(e){t.deleteCallback(t.content)}}})],1):t._e(),t.editCallback?n("button",{staticClass:"close mr-3 float-right",attrs:{type:"button"}},[n("b-icon-sliders",{on:{click:function(e){t.editCallback(t.content)}}})],1):t._e(),n("button",{staticClass:"card-text float-left btn",style:"background-color: rgb("+t.red+", "+t.green+", "+t.blue+")",attrs:{type:"button"},on:{click:function(e){t.clickCallback(t.content)}}},[n("h5",{staticClass:"m-0"},[t._v(t._s(t.content.name))])])]),""!=t.content.description?n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Описание: "+t._s(t.content.description))]):t._e(),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Количество видеороликов: "+t._s(t.countVideos))]),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Общая продолжительность: "+t._s(t.durationVideos))])])},K=[],Q={name:"Content",props:{content:Object,clickCallback:Function,editCallback:Function,deleteCallback:Function},computed:{user:function(){var t=this;return this.$store.state.manager.users?this.$store.state.manager.users.find(function(e){return e.id==t.content.account}):null},red:function(){var t=this.user;return t?t.red:255},green:function(){var t=this.user;return t?t.green:255},blue:function(){var t=this.user;return t?t.blue:255},videos:function(){var t=this;return this.$store.state.manager.contentVideos?this.$store.state.manager.contentVideos.filter(function(e){return e.content==t.content.id}):[]},countVideos:function(){return this.videos.length},durationVideos:function(){return this.msToTime(this.videos.reduce(function(t,e){return t+e.duration},0)/1e4)}},methods:{msToTime:function(t){var e=t%1e3;t=(t-e)/1e3;var n=t%60;t=(t-n)/60;var a=t%60,i=(t-a)/60;return this.timeFormat(i)+":"+this.timeFormat(a)+":"+this.timeFormat(n)},timeFormat:function(t){return t<10?"0".concat(t):t}}},W=Q,X=Object(c["a"])(W,G,K,!1,null,"4333fa36",null),Z=X.exports,tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},[n("b-icon-plus",{staticClass:"card plus mb-1",attrs:{"font-scale":"5"},on:{click:t.addContentVideo}}),n("div",{staticClass:"row"},t._l(t.contentVideos,function(e){return n("div",{key:e.id,staticClass:"col-md-4 p-1"},[n("VideoCard",{attrs:{video:e,deleteCallback:t.deleteVideo}})],1)}))],1)},et=[],nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card p-2 mb-0 mt-1"},[n("div",{staticClass:"align-items-center pr-2 pl-2 mb-1"},[t.deleteCallback?n("button",{staticClass:"close float-right",attrs:{type:"button"}},[n("b-icon-x",{attrs:{variant:"danger"},on:{click:function(e){t.deleteCallback(t.video)}}})],1):t._e()]),n("video",{ref:"video",staticClass:"img-fluid rounded",attrs:{controls:"",preload:"none"}},[n("source",{attrs:{src:"http://31.184.219.123:3666/video?video="+t.video.id}})])])},at=[],it={name:"VideoCard",props:{video:Object,deleteCallback:Function}},st=it,rt=Object(c["a"])(st,nt,at,!1,null,"23303cb9",null),ot=rt.exports,ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4 text-center"},[n("h4",[t._v("«"+t._s(t.collection.name)+"»")]),n("div",{staticClass:"input-group mb-3"},[t._m(0),n("input",{ref:"videos",staticClass:"form-control",attrs:{type:"file",accept:"video/mp4, video/x-m4v, video/*",multiple:""}})]),n("button",{staticClass:"btn btn-primary float-right mb-3",attrs:{type:"submit"},on:{click:t.save}},[t._v("Сохранить")])])},lt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Видеоролики")])])}],ut=n("ec26"),dt={name:"VideoForm",props:{collection:Object,uploaded:Function},methods:{save:function(){if(this.$refs.videos.files.length>0){var t={id:Object(ut["a"])(),collection:this.collection,videos:this.$refs.videos.files,uploaded:this.uploaded};this.$store.state.manager.uploads.push(t),this.$emit("close")}}}},ht=dt,mt=Object(c["a"])(ht,ct,lt,!1,null,"1f4c35e2",null),pt=mt.exports,ft={name:"ContentVideosModal",props:{content:Object},components:{VideoCard:ot},computed:{contentVideos:function(){var t=this;return this.$store.state.manager.contentVideos?this.$store.state.manager.contentVideos.filter(function(e){return e.content==t.content.id}):[]}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["deleteModel","postModel"])),{},{addContentVideo:function(){var t=this;this.$modal.show(pt,{collection:this.content,uploaded:function(){var e=Object(p["a"])(regeneratorRuntime.mark(function e(n,a){var i,s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=null,s={id:n,duration:a,content:t.content.id},r={model:s,modelName:"ContentVideo",callback:function(t){i=200==t.status}},e.next=5,t.postModel(r);case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}},e)}));function n(t,n){return e.apply(this,arguments)}return n}()},{height:"auto",width:"80%",scrollable:!0})},deleteVideo:function(t){var e=this,n=this.notify,a=this.content;this.$modal.show("dialog",{title:"Подтвердите действие",text:"Удалить видеоролик из альтернативного контента «".concat(this.content.name,"»?"),buttons:[{title:"Да",handler:function(){var i=Object(p["a"])(regeneratorRuntime.mark(function i(){var s;return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:return e.$modal.hide("dialog"),e.$store.state.manager.contentVideos=e.$store.state.manager.contentVideos.filter(function(e){return e.id!=t.id}),s={model:t,modelName:"ContentVideo",callback:function(e){200!=e.status?(this.$store.state.manager.contentVideos.push(t),n("Уведомление!","Видеоролик альтернативного контента «".concat(a.name,"» не удалось удалить!"),"danger")):n("Уведомление!","Видеоролик альтернативного контента «".concat(a.name,"» успешно удален!"),"success")}},i.next=5,e.deleteModel(s);case 5:case"end":return i.stop()}},i)}));function s(){return i.apply(this,arguments)}return s}()},{title:"Нет",handler:function(){e.$modal.hide("dialog")}}]})},notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},vt=ft,bt=Object(c["a"])(vt,tt,et,!1,null,"d39600b0",null),gt=bt.exports,Ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},[n("div",{staticClass:"input-group mb-3 mt-3"},[t._m(0),n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{disabled:t.saving,type:"text",placeholder:"..."},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),n("div",{staticClass:"input-group mb-3"},[t._m(1),n("input",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"form-control",attrs:{disabled:t.saving,type:"text",placeholder:"..."},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}})]),n("button",{staticClass:"btn btn-primary float-right mb-3",attrs:{disabled:t.saving,type:"submit"},on:{click:t.save}},[t._v("Сохранить")])])},_t=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Название")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Описание")])])}],kt={name:"ContentForm",props:{content:Object},data:function(){return{id:Object(ut["a"])(),founder:this.$store.getters.StateUser.username,name:"",description:"",account:this.$store.getters.StateUser.id,saving:!1}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel"])),{},{save:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e,n,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.saving=!0,e={id:this.id,founder:this.founder,name:this.name,description:this.description,account:this.account},n=this,a=this.notify,i={model:e,modelName:"Content",callback:function(t){200!=t.status?a("Уведомление!","Альтернативный контент «".concat(e.name,"» не удалось сохранить!"),"danger"):(n.$emit("close"),setTimeout(function(){return a("Уведомление!","Альтернативный контент «".concat(e.name,"» сохранен!"),"success")},0))}},t.next=8,this.postModel(i);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),notify("Уведомление!","Что-то пошло не так...","danger");case 13:return t.prev=13,this.saving=!1,t.finish(13);case 16:case"end":return t.stop()}},t,this,[[0,10,13,16]])}));function e(){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}}),created:function(){this.content&&(this.id=this.content.id,this.founder=this.content.founder,this.name=this.content.name,this.description=this.content.description,this.account=this.content.account)}},wt=kt,xt=Object(c["a"])(wt,Ct,_t,!1,null,"59a3ba8c",null),yt=xt.exports,$t={name:"ContentsCard",components:{ContentCard:Z},computed:{contents:function(){return this.$store.state.manager.contents?this.$store.state.manager.contents:[]}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["deleteModel"])),{},{showContentVideos:function(t){this.$modal.show(gt,{content:t},{height:"auto",width:"80%",scrollable:!0})},addContent:function(){this.$modal.show(yt,{content:null},{height:"auto",width:"60%",scrollable:!0})},editContent:function(t){this.$modal.show(yt,{content:t},{height:"auto",width:"60%",scrollable:!0})},deleteContent:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this,a=this.notify,this.$modal.show("dialog",{title:"Подтвердите действие",text:"Удалить альтернативный контент «".concat(e.name,"»?"),buttons:[{title:"Да",handler:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i.$modal.hide("dialog"),i.$store.state.manager.contents=i.$store.state.manager.contents.filter(function(t){return t.id!=e.id}),s={model:e,modelName:"Content",callback:function(t){200!=t.status?(n.$store.state.manager.contents.push(e),a("Уведомление!","Альтернативный контент «".concat(e.name,"» не удалось удалить!"),"danger")):a("Уведомление!","Альтернативный контент «".concat(e.name,"» удален!"),"success")}},t.next=5,i.deleteModel(s);case 5:case"end":return t.stop()}},t)}));function s(){return t.apply(this,arguments)}return s}()},{title:"Нет",handler:function(){i.$modal.hide("dialog")}}]});case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},Ot=$t,jt=Object(c["a"])(Ot,J,q,!1,null,"f8aecc72",null),Rt=jt.exports,Tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},[n("b-icon-plus",{staticClass:"card plus mb-1",attrs:{"font-scale":"5"},on:{click:t.addClient}}),t._l(t.clients,function(e){return n("ClientCard",{key:e.id,attrs:{client:e,clickCallback:t.showClientVideos,editCallback:t.editClient,deleteCallback:t.deleteClient}})})],2)},Mt=[],Dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card p-2 mb-0 mt-1"},[n("div",{staticClass:"align-items-center pt-2 pr-2 pl-2"},[t.deleteCallback?n("button",{staticClass:"close float-right",attrs:{type:"button"}},[n("b-icon-x",{attrs:{variant:"danger"},on:{click:function(e){t.deleteCallback(t.client)}}})],1):t._e(),t.editCallback?n("button",{staticClass:"close mr-3 float-right",attrs:{type:"button"}},[n("b-icon-sliders",{on:{click:function(e){t.editCallback(t.client)}}})],1):t._e(),n("button",{staticClass:"card-text float-left btn",style:"background-color: rgb("+t.red+", "+t.green+", "+t.blue+")",attrs:{type:"button"},on:{click:function(e){t.clickCallback(t.client)}}},[n("h5",{staticClass:"m-0"},[t._v(t._s(t.client.name))])])]),""!=t.client.description?n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Описание: "+t._s(t.client.description))]):t._e(),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Количество видеороликов: "+t._s(t.countVideos))]),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Общая продолжительность: "+t._s(t.durationVideos))])])},Vt=[],St={name:"Client",props:{client:Object,clickCallback:Function,editCallback:Function,deleteCallback:Function},computed:{user:function(){var t=this.client;return null==t?null:this.$store.state.manager.users?this.$store.state.manager.users.find(function(e){return e.id==t.account}):null},red:function(){var t=this.user;return t?t.red:255},green:function(){var t=this.user;return t?t.green:255},blue:function(){var t=this.user;return t?t.blue:255},videos:function(){var t=this;return this.$store.state.manager.clientVideos?this.$store.state.manager.clientVideos.filter(function(e){return t.client.id==e.ads_client}):[]},countVideos:function(){return this.videos.length},durationVideos:function(){return this.msToTime(this.videos.reduce(function(t,e){return t+e.duration},0)/1e4)}},methods:{msToTime:function(t){var e=t%1e3;t=(t-e)/1e3;var n=t%60;t=(t-n)/60;var a=t%60,i=(t-a)/60;return this.timeFormat(i)+":"+this.timeFormat(a)+":"+this.timeFormat(n)},timeFormat:function(t){return t<10?"0".concat(t):t}}},Nt=St,Lt=Object(c["a"])(Nt,Dt,Vt,!1,null,"e3453faa",null),Et=Lt.exports,Ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},[n("b-icon-plus",{staticClass:"card plus mb-1",attrs:{"font-scale":"5"},on:{click:t.addClientVideo}}),n("div",{staticClass:"row"},t._l(t.clientVideos,function(e){return n("div",{key:e.id,staticClass:"col-md-4 p-1"},[n("VideoCard",{attrs:{video:e,deleteCallback:t.deleteVideo}})],1)}))],1)},Ut=[],At={name:"ClientVideosModal",props:{client:Object},components:{VideoCard:ot},computed:{clientVideos:function(){var t=this;return this.$store.state.manager.clientVideos?this.$store.state.manager.clientVideos.filter(function(e){return e.ads_client==t.client.id}):[]}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["deleteModel","postModel"])),{},{addClientVideo:function(){var t=this;this.$modal.show(pt,{collection:this.client,uploaded:function(){var e=Object(p["a"])(regeneratorRuntime.mark(function e(n,a){var i,s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=null,s={id:n,duration:a,ads_client:t.client.id},r={model:s,modelName:"AdvertisingVideo",callback:function(t){i=200==t.status}},e.next=5,t.postModel(r);case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}},e)}));function n(t,n){return e.apply(this,arguments)}return n}()},{height:"auto",width:"80%",scrollable:!0})},deleteVideo:function(t){var e=this,n=this.notify,a=this.client;this.$modal.show("dialog",{title:"Подтвердите действие",text:"Удалить видеоролик из клиента «".concat(this.client.name,"»?"),buttons:[{title:"Да",handler:function(){var i=Object(p["a"])(regeneratorRuntime.mark(function i(){var s;return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:return e.$modal.hide("dialog"),e.$store.state.manager.clientVideos=e.$store.state.manager.clientVideos.filter(function(e){return e.id!=t.id}),s={model:t,modelName:"AdvertisingVideo",callback:function(e){200!=e.status?(this.$store.state.manager.clientVideos.push(t),n("Уведомление!","Видеоролик клиента «".concat(a.name,"» не удалось удалить!"),"danger")):n("Уведомление!","Видеоролик клиента «".concat(a.name,"» успешно удален!"),"success")}},i.next=5,e.deleteModel(s);case 5:case"end":return i.stop()}},i)}));function s(){return i.apply(this,arguments)}return s}()},{title:"Нет",handler:function(){e.$modal.hide("dialog")}}]})},notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},Pt=At,It=Object(c["a"])(Pt,Ft,Ut,!1,null,"06a72129",null),Ht=It.exports,Yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},[n("div",{staticClass:"input-group mb-3 mt-3"},[t._m(0),n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{disabled:t.saving,type:"text",placeholder:"..."},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),n("div",{staticClass:"input-group mb-3"},[t._m(1),n("input",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"form-control",attrs:{disabled:t.saving,type:"text",placeholder:"..."},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}})]),n("button",{staticClass:"btn btn-primary float-right mb-3",attrs:{disabled:t.saving,type:"submit"},on:{click:t.save}},[t._v("Сохранить")])])},zt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Название")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Описание")])])}],Bt={name:"ClientForm",props:{client:Object},data:function(){return{id:Object(ut["a"])(),founder:this.$store.getters.StateUser.username,name:"",description:"",account:this.$store.getters.StateUser.id,saving:!1}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel"])),{},{save:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e,n,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.saving=!0,e={id:this.id,founder:this.founder,name:this.name,description:this.description,account:this.account},n=this,a=this.notify,i={model:e,modelName:"AdvertisingClient",callback:function(t){200!=t.status?a("Уведомление!","Клиента «".concat(e.name,"» не удалось сохранить!"),"danger"):(n.$emit("close"),setTimeout(function(){return a("Уведомление!","Клиент «".concat(e.name,"» сохранен!"),"success")},0))}},t.next=8,this.postModel(i);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),notify("Уведомление!","Что-то пошло не так...","danger");case 13:return t.prev=13,this.saving=!1,t.finish(13);case 16:case"end":return t.stop()}},t,this,[[0,10,13,16]])}));function e(){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}}),created:function(){this.client&&(this.id=this.client.id,this.founder=this.client.founder,this.name=this.client.name,this.description=this.client.description,this.account=this.client.account)}},Jt=Bt,qt=Object(c["a"])(Jt,Yt,zt,!1,null,"1a46f944",null),Gt=qt.exports,Kt={name:"ClientsCard",components:{ClientCard:Et},computed:{clients:function(){return this.$store.state.manager.clients?this.$store.state.manager.clients:[]}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["deleteModel"])),{},{showClientVideos:function(t){this.$modal.show(Ht,{client:t},{height:"auto",width:"80%",scrollable:!0})},addClient:function(){this.$modal.show(Gt,{client:null},{height:"auto",width:"60%",scrollable:!0})},editClient:function(t){this.$modal.show(Gt,{client:t},{height:"auto",width:"60%",scrollable:!0})},deleteClient:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this,a=this.notify,this.$modal.show("dialog",{title:"Подтвердите действие",text:"Удалить клиента «".concat(e.name,"»?"),buttons:[{title:"Да",handler:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i.$modal.hide("dialog"),i.$store.state.manager.clients=i.$store.state.manager.clients.filter(function(t){return t.id!=e.id}),s={model:e,modelName:"AdvertisingClient",callback:function(t){200!=t.status?(n.$store.state.manager.clients.push(e),a("Уведомление!","Клиента «".concat(e.name,"» не удалось удалить!"),"danger")):a("Уведомление!","Клиент «".concat(e.name,"» удален!"),"success")}},t.next=5,i.deleteModel(s);case 5:case"end":return t.stop()}},t)}));function s(){return t.apply(this,arguments)}return s}()},{title:"Нет",handler:function(){i.$modal.hide("dialog")}}]});case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},Qt=Kt,Wt=Object(c["a"])(Qt,Tt,Mt,!1,null,"08e7052a",null),Xt=Wt.exports,Zt={name:"account-panel",data:function(){return{interval:null,time:null}},beforeDestroy:function(){clearInterval(this.interval)},created:function(){this.timeTick(),this.interval=setInterval(this.timeTick,1e3)},methods:{timeTick:function(){this.time=Intl.DateTimeFormat(navigator.language,{hour:"numeric",minute:"numeric",second:"numeric"}).format()},showContents:function(){this.$modal.show(Rt,{},{height:"auto",width:"80%",scrollable:!0})},showClients:function(){this.$modal.show(Xt,{},{height:"auto",width:"80%",scrollable:!0})},showDevices:function(){},logout:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("LogOut");case 2:this.$router.push("/login");case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},te=Zt,ee=Object(c["a"])(te,z,B,!1,null,"e9d05ab2",null),ne=ee.exports,ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card mt-3 mb-3"},[n("div",{staticClass:"card-body"},[t.existUploads?n("div",[n("h4",{staticClass:"card-title"},[t._v("Загрузка видеороликов")]),t._l(t.uploads,function(t){return n("UploadCard",{key:t.id,attrs:{upload:t}})})],2):t._e(),t.existDevices?n("div",[n("h4",{staticClass:"card-title"},[t._v("Информация о приставках")]),t._l(t.deviceRecords,function(e){return n("InfoDeviceCard",{key:e.device.id,attrs:{device:e.device,channel:e.channel,deleteCallback:t.deleteDevice}})})],2):t._e()])])},ie=[],se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card p-2 mb-0 mt-1"},[n("div",{staticClass:"card-title"},[n("div",{staticClass:"align-items-center"},[n("button",{staticClass:"close float-right",attrs:{type:"button"}},[n("b-icon-x",{attrs:{variant:"danger"},on:{click:t.deleteUpload}})],1),n("h5",[t._v("«"+t._s(t.upload.collection.name)+"»")])]),n("p",[t._v("Видеоролик -> "+t._s(t.video?t.video.name:"?"))]),n("b-progress",{attrs:{value:t.uploaded,max:t.videos,"show-progress":"",animated:""}})],1)])},re=[],oe={name:"UploadCard",props:{upload:Object},computed:{videos:function(){return this.upload.videos.length}},data:function(){return{uploaded:0,video:null,uploading:!0}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel","uploadVideo"])),{},{uploadVideos:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e,n,a,i,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=this,n=this.notify,a=0;case 3:if(!(a<this.videos&&this.uploading)){t.next=12;break}return this.uploaded=a,this.video=this.upload.videos[a],i={video:this.video,callback:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(n),200!=n.status){t.next=7;break}return t.next=4,e.upload.uploaded(n.data.file,n.data.duration);case 4:e.uploading=t.sent,t.next=8;break;case 7:e.uploading=!1;case 8:case"end":return t.stop()}},t)}));function n(e){return t.apply(this,arguments)}return n}()},t.next=9,this.uploadVideo(i);case 9:a++,t.next=3;break;case 12:this.$store.state.manager.uploads=this.$store.state.manager.uploads.filter(function(t){return t.id!=s.upload.id}),0==this.uploading?setTimeout(function(){return n("Уведомление!","Не удалось загрузить видеоролики «".concat(s.upload.collection.name,"»!"),"danger")},0):setTimeout(function(){return n("Уведомление!","Видеоролики «".concat(s.upload.collection.name,"» успешно загружены!"),"success")},0);case 14:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),deleteUpload:function(){var t=this;this.$modal.show("dialog",{title:"Подтвердите действие",text:"Остановить загрузку видеороликов «".concat(this.upload.collection.name,"»?"),buttons:[{title:"Да",handler:function(){t.uploading=!1,t.$modal.hide("dialog")}},{title:"Нет",handler:function(){t.$modal.hide("dialog")}}]})},notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}}),created:function(){this.video=this.upload.videos[0],setTimeout(this.uploadVideos,1e3)}},ce=oe,le=Object(c["a"])(ce,se,re,!1,null,"582c7e1b",null),ue=le.exports,de=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.device.info.DeviceStatus?"card mt-1 mb-0 offline-card":"card mt-1 mb-0"},[n("div",{staticClass:"card-title p-2 mb-0"},[n("div",{staticClass:"mb-0"},[n("div",{staticClass:"align-items-center pt-2 pr-2 pl-2"},[n("strong",{staticClass:"float-left"},[1&t.device.info.DeviceStatus?n("b-icon",{attrs:{icon:"link45deg","font-scale":"2",variant:"danger"}}):n("b-icon",{attrs:{icon:"link45deg","font-scale":"2",variant:"success"}}),t._v("\n                    "+t._s(void 0!=t.channel?t.channel.name+" -> "+t.device.name:""+t.device.name)+"\n                    "),t.device.address?n("small",{staticClass:"text-muted ml-2"},[t._v("("+t._s(t.device.address)+")")]):t._e()],1),t.deleteCallback?n("button",{staticClass:"close float-right",attrs:{type:"button"}},[n("b-icon-x",{attrs:{variant:"danger"},on:{click:function(e){t.deleteCallback(t.device)}}})],1):t._e(),t.editCallback?n("button",{staticClass:"close mr-2 float-right",attrs:{type:"button"}},[n("b-icon-sliders",{on:{click:function(e){t.editCallback(t.device)}}})],1):t._e(),1&t.device.info.DeviceStatus?n("small",{staticClass:"text-muted float-right mr-2"},[t._v(t._s(t.timePassed))]):t._e()])])]),1&t.device.info.DeviceStatus?n("div",{staticClass:"card-body p-0 m-0"},[n("p",{staticClass:"card-text ml-4 p-0 mb-1"},[t._v("Статус: Offline")])]):n("div",{staticClass:"card-body p-0 m-0"},[n("p",{staticClass:"card-text ml-4 p-0 mb-1"},[t._v("Статус: Online")]),0!=t.device.info.DeviceStatus?n("p",{staticClass:"card-text ml-4 mb-0 mt-1"},[t._v("Ошибки:")]):t._e(),n("ul",{staticClass:"ml-4 mb-0 mt-0"},[t.device.info.DeviceStatus>>1&1?n("li",[t._v("Не удается скачать видеоролик")]):t._e(),t.device.info.DeviceStatus>>2&1?n("li",[t._v("Что-то мешает воспроизведению видеоролика")]):t._e(),t.device.info.DeviceStatus>>3&1?n("li",[t._v("HDMI кабель не подсоединен")]):t._e()])])])},he=[],me={name:"InfoDeviceCard",props:{device:Object,channel:Object,editCallback:Function,deleteCallback:Function},data:function(){return{timeout:null,timePassed:""}},methods:{timeTick:function(){var t,e=new Date,n=new Date(Date.parse(this.device.last_online));(t=pe.inSeconds(n,e))<60?(this.timePassed=be.forSeconds(n,t),this.timeout=setTimeout(this.timeTick,1e3)):(t=pe.inMinutes(n,e))<60?(this.timePassed=be.forMinutes(n,t),this.timeout=setTimeout(this.timeTick,1e3)):(t=pe.inHours(n,e))<24?(this.timePassed=be.forHours(n,t),this.timeout=setTimeout(this.timeTick,6e4)):(t=pe.inDays(n,e))<365?(this.timePassed=be.forDays(n,t),this.timeout=setTimeout(this.timeTick,36e5)):(this.timePassed=be.forYears(n,pe.inYears(n,e)),this.timeout=setTimeout(this.timeTick,864e5))}},created:function(){this.timeTick()},beforeDestroy:function(){this.timeout&&clearTimeout(this.timeout)}},pe={inYears:function(t,e){var n=e.getFullYear(),a=t.getFullYear();return parseInt(n-a)},inDays:function(t,e){var n=e.getTime(),a=t.getTime();return parseInt((n-a)/864e5)},inHours:function(t,e){var n=e.getTime(),a=t.getTime();return parseInt((n-a)/36e5)},inMinutes:function(t,e){var n=e.getTime(),a=t.getTime();return parseInt((n-a)/6e4)},inSeconds:function(t,e){var n=e.getTime(),a=t.getTime();return parseInt((n-a)/1e3)}};function fe(t){return(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())}function ve(t){return t.toLocaleDateString()+" "+fe(t)}var be={forSeconds:function(t,e){return fe(t)+" ("+e+" секунд назад)"},forMinutes:function(t,e){return fe(t)+" ("+e+" минут назад)"},forHours:function(t,e){return fe(t)+" ("+e+" часов назад)"},forDays:function(t,e){return ve(t)+" ("+e+" дней назад)"},forYears:function(t,e){return ve(t)+" ("+e+" лет назад)"}},ge=me,Ce=Object(c["a"])(ge,de,he,!1,null,"151695da",null),_e=Ce.exports,ke={name:"InformationPanel",components:{UploadCard:ue,InfoDeviceCard:_e},computed:{existUploads:function(){return this.$store.state.manager.uploads.length>0},uploads:function(){return this.$store.state.manager.uploads},existDevices:function(){return null!=this.$store.state.manager.devices},deviceRecords:function(){var t=this;if(this.$store.state.manager.devices){var e=[];return this.$store.state.manager.devices.forEach(function(n){var a=t.$store.state.manager.channels?t.$store.state.manager.channels.find(function(t){return t.id==n.channel}):void 0;e.push({device:n,channel:a})}),e=e.sort(function(t,e){return void 0==t.channel&&void 0!=e.channel?1:void 0!=t.channel&&void 0==e.channel?-1:void 0==t.channel&&void 0==e.channel?t.device.name.toLowerCase()>e.device.name.toLowerCase()?1:e.device.name.toLowerCase()>t.device.name.toLowerCase()?-1:0:void 0!=t.channel&&void 0!=e.channel?t.channel.name==e.channel.name?t.device.name.toLowerCase()>e.device.name.toLowerCase()?1:e.device.name.toLowerCase()>t.device.name.toLowerCase()?-1:0:t.channel.name.toLowerCase()>e.channel.name.toLowerCase()?1:e.channel.name.toLowerCase()>t.channel.name.toLowerCase()?-1:0:void 0}),e}return[]}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["deleteModel"])),{},{deleteDevice:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this,a=this.notify,this.$modal.show("dialog",{title:"Подтвердите действие",text:"Удалить приставку «".concat(e.name,"»?"),buttons:[{title:"Да",handler:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i.$modal.hide("dialog"),i.$store.state.manager.devices=i.$store.state.manager.devices.filter(function(t){return t.id!=e.id}),s={model:e,modelName:"DeviceState",callback:function(t){200!=t.status?(n.$store.state.manager.devices.push(e),a("Уведомление!","Приставку «".concat(e.name,"» не удалось удалить!"),"danger")):a("Уведомление!","Приставка «".concat(e.name,"» удалена!"),"success")}},t.next=5,i.deleteModel(s);case 5:case"end":return t.stop()}},t)}));function s(){return t.apply(this,arguments)}return s}()},{title:"Нет",handler:function(){i.$modal.hide("dialog")}}]});case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},we=ke,xe=Object(c["a"])(we,ae,ie,!1,null,"27039456",null),ye=xe.exports,$e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card mb-1"},[n("div",{staticClass:"align-items-center pt-2 pr-2 pl-2 mb-1"},[t.deleteCallback?n("button",{staticClass:"close float-right",attrs:{type:"button"}},[n("b-icon-x",{attrs:{variant:"danger"},on:{click:function(e){t.deleteCallback(t.channel)}}})],1):t._e(),t.editCallback?n("button",{staticClass:"close mr-3 float-right",attrs:{type:"button"}},[n("b-icon-sliders",{on:{click:function(e){t.editCallback(t.channel)}}})],1):t._e(),n("button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"channel-"+t.channel.id,expression:"`channel-${channel.id}`"}],staticClass:"card-text float-left btn",style:"background-color: rgb("+t.red+", "+t.green+", "+t.blue+")",attrs:{type:"button"}},[n("h5",{staticClass:"m-0"},[t._v(t._s(t.channel.name))])])]),""!=t.channel.description?n("div",{staticClass:"card-text ml-2 mb-1"},[n("p",{staticClass:"m-0"},[t._v("Описание: "+t._s(t.channel.description))])]):t._e(),n("b-collapse",{attrs:{id:"channel-"+t.channel.id,accordion:"channel"}},[n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Создал: "+t._s(t.channel.founder))]),n("div",{staticClass:"row mx-auto"},["00000000-0000-0000-0000-000000000000"==t.channel.logo_left||void 0==t.channel.logo_left?n("div",{staticClass:"col-sm-6 p-1"},[n("img",{staticClass:"rounded image-link",staticStyle:{"max-width":"100%"},attrs:{href:"/images/background.jpg",src:"/images/background.jpg"}})]):n("div",{staticClass:"col-sm-6 p-1"},[n("img",{staticClass:"rounded image-link",staticStyle:{"max-width":"100%"},attrs:{href:"http://31.184.219.123:3666/logo?logo="+t.channel.logo_left,src:"http://31.184.219.123:3666/logo?logo="+t.channel.logo_left}})]),"00000000-0000-0000-0000-000000000000"==t.channel.logo_right||void 0==t.channel.logo_right?n("div",{staticClass:"col-sm-6 p-1"},[n("img",{staticClass:"rounded image-link",staticStyle:{"max-width":"100%"},attrs:{href:"/images/background.jpg",src:"/images/background.jpg"}})]):n("div",{staticClass:"col-sm-6 p-1"},[n("img",{staticClass:"rounded image-link",staticStyle:{"max-width":"100%"},attrs:{href:"http://31.184.219.123:3666/logo?logo="+t.channel.logo_right,src:"http://31.184.219.123:3666/logo?logo="+t.channel.logo_right}})])]),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Ориентация экранов: "+t._s(t.channel.orientation?"вертикальная":"горизонтальная"))]),""!=t.channel.ticker?n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Бегущая строка: "+t._s(t.channel.ticker))]):t._e(),""!=t.channel.ticker?n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Интервал бегущей строки: "+t._s(t.tickerInterval)+" мин")]):t._e(),n("p",{staticClass:"card-text ml-2 mb-1"},[t._v("Время перезагрузки приставки (каждый день): "+t._s(t.reloadTime))]),n("div",{staticClass:"row mx-auto"},[n("button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"contents-"+t.channel.id,expression:"`contents-${channel.id}`"}],staticClass:"card-text col btn m-1",style:"background-color: rgb("+t.red+", "+t.green+", "+t.blue+")",attrs:{type:"button"}},[n("h5",{staticClass:"m-0"},[t._v("Контент")])]),n("button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"clients-"+t.channel.id,expression:"`clients-${channel.id}`"}],staticClass:"card-text col btn m-1",style:"background-color: rgb("+t.red+", "+t.green+", "+t.blue+")",attrs:{type:"button"}},[n("h5",{staticClass:"m-0"},[t._v("Клиенты")])]),n("button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"orders-"+t.channel.id,expression:"`orders-${channel.id}`"}],staticClass:"card-text col btn m-1",style:"background-color: rgb("+t.red+", "+t.green+", "+t.blue+")",attrs:{type:"button"}},[n("h5",{staticClass:"m-0"},[t._v("Очередность")])]),n("button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"devices-"+t.channel.id,expression:"`devices-${channel.id}`"}],staticClass:"card-text col btn m-1",style:"background-color: rgb("+t.red+", "+t.green+", "+t.blue+")",attrs:{type:"button"}},[n("h5",{staticClass:"m-0"},[t._v("Приставки")])])]),n("div",{staticClass:"accordion mx-auto"},[n("b-collapse",{staticClass:"border rounded m-1 p-1",attrs:{id:"contents-"+t.channel.id,accordion:"accordion-"+t.channel.id}},[n("b-icon-plus",{staticClass:"card plus mb-1",attrs:{"font-scale":"5"},on:{click:t.showAddContentModal}}),t._l(t.contents,function(e){return n("ContentCard",{key:t.channel.id+e.id,attrs:{content:e,clickCallback:t.contentClicked,deleteCallback:t.deleteContent}})})],2),n("b-collapse",{staticClass:"border rounded m-1 p-1",attrs:{id:"clients-"+t.channel.id,accordion:"accordion-"+t.channel.id}},[n("b-icon-plus",{staticClass:"card plus mb-1",attrs:{"font-scale":"5"},on:{click:t.showAddClientModal}}),t._l(t.clientChannels,function(e){return n("ClientChannelCard",{key:t.channel.id+e.id,attrs:{clientChannel:e,clickCallback:t.showClientChannelVideosModal,editCallback:t.editClientChannel,deleteCallback:t.deleteClientChannel}})})],2),n("b-collapse",{staticClass:"border rounded m-1 p-1",attrs:{id:"orders-"+t.channel.id,accordion:"accordion-"+t.channel.id}},[n("b-icon-plus",{staticClass:"card plus mb-1",attrs:{"font-scale":"5"},on:{click:t.showAddOrderModal}}),t._l(t.orders,function(e){return n("OrderCard",{key:t.channel.id+e.id,attrs:{order:e,deleteCallback:t.deleteOrder}})})],2),n("b-collapse",{staticClass:"border rounded m-1 p-1",attrs:{id:"devices-"+t.channel.id,accordion:"accordion-"+t.channel.id}},[n("b-icon-plus",{staticClass:"card plus mb-1",attrs:{"font-scale":"5"},on:{click:t.showAddDeviceModal}}),t._l(t.devices,function(e){return n("DeviceCard",{key:t.channel.id+e.id,attrs:{device:e,clickCallback:t.showFullDeviceInfo,deleteCallback:t.removeDevice}})})],2)],1)])],1)},Oe=[],je=(n("6762"),n("2fdb"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card p-2 mb-0 mt-1"},[n("div",{staticClass:"align-items-center pt-2 pr-2 pl-2"},[t.deleteCallback?n("button",{staticClass:"close float-right",attrs:{type:"button"}},[n("b-icon-x",{attrs:{variant:"danger"},on:{click:function(e){t.deleteCallback(t.clientChannel)}}})],1):t._e(),t.editCallback?n("button",{staticClass:"close mr-3 float-right",attrs:{type:"button"}},[n("b-icon-sliders",{on:{click:function(e){t.editCallback(t.clientChannel)}}})],1):t._e(),n("button",{staticClass:"card-text float-left btn",style:"background-color: rgb("+t.red+", "+t.green+", "+t.blue+")",attrs:{type:"button"},on:{click:function(e){t.clickCallback(t.clientChannel)}}},[n("h5",{staticClass:"m-0"},[t._v(t._s(t.client?t.client.name:"?"))])])]),t.client&&""!=t.client.description?n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Описание: "+t._s(t.client.description))]):t._e(),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Интервал показа: "+t._s(t.interval)+" мин")]),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Количество видеороликов: "+t._s(t.countVideos))]),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Общая продолжительность: "+t._s(t.durationVideos))])])}),Re=[],Te={name:"ClientChannel",props:{clientChannel:Object,clickCallback:Function,editCallback:Function,deleteCallback:Function},computed:{client:function(){var t=this;return this.$store.state.manager.clients?this.$store.state.manager.clients.find(function(e){return e.id==t.clientChannel.ads_client}):null},user:function(){var t=this.client;return null==t?{}:this.$store.state.manager.users?this.$store.state.manager.users.find(function(e){return e.id==t.account}):{}},red:function(){var t=this.user;return t?t.red:255},green:function(){var t=this.user;return t?t.green:255},blue:function(){var t=this.user;return t?t.blue:255},videos:function(){var t=this;return this.$store.state.manager.clientVideos?this.$store.state.manager.clientVideos.filter(function(e){return t.clientChannel.ads_videos.includes(e.id)}):[]},countVideos:function(){return this.videos.length},durationVideos:function(){return this.msToTime(this.videos.reduce(function(t,e){return t+e.duration},0)/1e4)},interval:function(){return this.msToMinutes(this.clientChannel.interval/1e4)}},methods:{msToMinutes:function(t){var e=t%1e3;t=(t-e)/1e3;var n=t%60;return t=(t-n)/60,t},msToTime:function(t){var e=t%1e3;t=(t-e)/1e3;var n=t%60;t=(t-n)/60;var a=t%60,i=(t-a)/60;return this.timeFormat(i)+":"+this.timeFormat(a)+":"+this.timeFormat(n)},timeFormat:function(t){return t<10?"0".concat(t):t}}},Me=Te,De=Object(c["a"])(Me,je,Re,!1,null,"c2d288ea",null),Ve=De.exports,Se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card p-2 mb-0 mt-1"},[n("div",{staticClass:"align-items-center pt-2 pr-2 pl-2"},[t.deleteCallback?n("button",{staticClass:"close float-right",attrs:{type:"button"}},[n("b-icon-x",{attrs:{variant:"danger"},on:{click:function(e){t.deleteCallback(t.order)}}})],1):t._e(),n("div",{staticClass:"card-text float-left"},[n("h5",{staticClass:"m-0"},[t._v(t._s(t.client?t.client.name:"?"))])])]),t.client&&""!=t.client.description?n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Описание: "+t._s(t.client.description))]):t._e()])},Ne=[],Le={name:"Order",props:{order:Object,deleteCallback:Function},computed:{client:function(){var t=this,e=this.$store.state.manager.clientChannels?this.$store.state.manager.clientChannels.find(function(e){return e.id==t.order.ads_client_channel}):null;return null==e?{}:this.$store.state.manager.clients?this.$store.state.manager.clients.find(function(t){return t.id==e.ads_client}):{}}}},Ee=Le,Fe=Object(c["a"])(Ee,Se,Ne,!1,null,"51e213ad",null),Ue=Fe.exports,Ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card p-2 mb-0 mt-1"},[n("div",{staticClass:"align-items-center pt-2 pr-2 pl-2"},[t.deleteCallback?n("button",{staticClass:"close float-right",attrs:{type:"button"}},[n("b-icon-x",{attrs:{variant:"danger"},on:{click:function(e){t.deleteCallback(t.device)}}})],1):t._e(),t.editCallback?n("button",{staticClass:"close mr-3 float-right",attrs:{type:"button"}},[n("b-icon-sliders",{on:{click:function(e){t.editCallback(t.device)}}})],1):t._e(),n("button",{staticClass:"card-text float-left btn",class:1&t.device.info.DeviceStatus?"btn-danger":"btn-success",attrs:{type:"button"},on:{click:function(e){t.clickCallback(t.device)}}},[n("h5",{staticClass:"m-0"},[t._v(t._s(t.device.name))])])]),t.device.address?n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Адрес: "+t._s(t.device.address))]):t._e(),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Видеоролики: "+t._s(t.device.info.ReadyVideosCount)+" шт.")]),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Прогресс скачивания: "+t._s(t.device.info.DownloadProgress)+"%")]),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Скорость скачивания: "+t._s(Math.round(t.device.info.DownloadSpeed/1024))+" кбайт/с")]),n("p",{staticClass:"card-text ml-2 mb-0"},[t._v("Версия ПО: "+t._s(t.device.info.Version))]),1&t.device.info.DeviceStatus?n("div",{staticClass:"card-body p-0 m-0"},[n("p",{staticClass:"card-text ml-2 p-0 mb-1"},[t._v("Статус: Offline")])]):n("div",{staticClass:"card-body p-0 m-0"},[n("p",{staticClass:"card-text ml-2 p-0 mb-1"},[t._v("Статус: Online")]),0!=t.device.info.DeviceStatus?n("p",{staticClass:"card-text ml-2 mb-0 mt-1"},[t._v("Ошибки:")]):t._e(),n("ul",{staticClass:"ml-2 mb-0 mt-0"},[t.device.info.DeviceStatus>>1&1?n("li",[t._v("Не удается скачать видеоролик")]):t._e(),t.device.info.DeviceStatus>>2&1?n("li",[t._v("Что-то мешает воспроизведению видеоролика")]):t._e(),t.device.info.DeviceStatus>>3&1?n("li",[t._v("HDMI кабель не подсоединен")]):t._e()])])])},Pe=[],Ie={name:"DeviceCard",props:{device:Object,clickCallback:Function,editCallback:Function,deleteCallback:Function}},He=Ie,Ye=Object(c["a"])(He,Ae,Pe,!1,null,"e37fbd70",null),ze=Ye.exports,Be=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4 text-center"},[n("h4",[t._v("«"+t._s(t.client.name)+"»")]),n("div",{staticClass:"input-group mb-3"},[t._m(0),n("input",{staticClass:"form-control",attrs:{type:"time"},on:{change:t.changed}})])])},Je=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Интервал показа")])])}],qe={name:"ClientChannelForm",props:{clientChannel:Object},computed:{client:function(){var t=this;return this.$store.state.manager.clients?this.$store.state.manager.clients.find(function(e){return e.id==t.clientChannel.ads_client}):{}}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel"])),{},{changed:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i,s,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=this.notify,a=this.client,i=this.clientChannel,s=i.interval,i.interval=1e4*e.target.valueAsNumber,r={model:i,modelName:"ClientChannel",callback:function(t){200!=t.status?(i.interval=s,n("Уведомление!","Интервал показа клиента «".concat(a.name,"» не удалось изменить!"),"danger")):n("Уведомление!","Интервал показа клиента «".concat(a.name,"» изменен!"),"success")}},t.next=8,this.postModel(r);case 8:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},Ge=qe,Ke=Object(c["a"])(Ge,Be,Je,!1,null,"3cd514a5",null),Qe=Ke.exports,We=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},t._l(t.contents,function(e){return n("ContentCard",{key:e.id,attrs:{content:e,clickCallback:t.addContent}})}))},Xe=[],Ze={name:"AddContentModal",props:{channel:Object},components:{ContentCard:Z},computed:{contents:function(){var t=this;return this.$store.state.manager.contents?this.$store.state.manager.contents.filter(function(e){return 0==t.channel.contents.includes(e.id)}):[]}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel"])),{},{addContent:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(n=this.notify,a=this.channel,0!=a.contents.includes(e.id)){t.next=7;break}return a.contents.push(e.id),i={model:a,modelName:"Channel",callback:function(t){200!=t.status?(a.contents=a.contents.filter(function(t){return t!=e.id}),n("Уведомление!","Альтернативный контент «".concat(e.name,"» не удалось добавить в канал «").concat(a.name,"»!"),"danger")):n("Уведомление!","Альтернативный контент «".concat(e.name,"» добавлен в канал «").concat(a.name,"»!"),"success")}},t.next=7,this.postModel(i);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},tn=Ze,en=Object(c["a"])(tn,We,Xe,!1,null,"2542274e",null),nn=en.exports,an=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},t._l(t.clients,function(e){return n("ClientCard",{key:e.id,attrs:{client:e,clickCallback:t.addClient}})}))},sn=[],rn={name:"AddClientModal",props:{channel:Object},components:{ClientCard:Et},computed:{clientChannels:function(){return this.$store.state.manager.clientChannels?this.$store.state.manager.clientChannels:[]},clients:function(){var t=this;return this.$store.state.manager.clients?this.$store.state.manager.clients.filter(function(e){return void 0==t.isClientAdded(e)}):[]}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel"])),{},{isClientAdded:function(t){var e=this;return this.clientChannels.find(function(n){return n.ads_client==t.id&&n.channel==e.channel.id})},adsVideos:function(t){var e=[],n=this.$store.state.manager.clientVideos?this.$store.state.manager.clientVideos.filter(function(e){return e.ads_client==t.id}):[];return n.forEach(function(t){return e.push(t.id)}),e},addClient:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i,s,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(void 0!=this.isClientAdded(e)){t.next=9;break}return n={id:Object(ut["a"])(),interval:0,channel:this.channel.id,ads_client:e.id,ads_videos:this.adsVideos(e)},a=this.notify,i=this.channel,s=this.removeClientChannel,this.$store.state.manager.clientChannels.push(n),r={model:n,modelName:"ClientChannel",callback:function(t){200!=t.status?(s(n),a("Уведомление!","Клиента «".concat(e.name,"» не удалось добавить в канал «").concat(i.name,"»!"),"danger")):a("Уведомление!","Клиент «".concat(e.name,"» добавлен в канал «").concat(i.name,"»!"),"success")}},t.next=9,this.postModel(r);case 9:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),removeClientChannel:function(t){this.$store.state.manager.clientChannels=this.$store.state.manager.clientChannels.filter(function(e){return e.id!=t.id})},notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},on=rn,cn=Object(c["a"])(on,an,sn,!1,null,"fb2121bc",null),ln=cn.exports,un=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},t._l(t.clientChannels,function(e){return n("ClientChannelCard",{key:e.id,attrs:{clientChannel:e,clickCallback:t.addOrder}})}))},dn=[],hn={name:"AddOrderModal",props:{channel:Object},components:{ClientChannelCard:Ve},computed:{clientChannels:function(){var t=this;return this.$store.state.manager.clientChannels?this.$store.state.manager.clientChannels.filter(function(e){return e.channel==t.channel.id}):[]}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel"])),{},{client:function(t){var e=this.$store.state.manager.clientChannels?this.$store.state.manager.clientChannels.find(function(e){return e.id==t.ads_client_channel}):null;return null==e?null:this.$store.state.manager.clients?this.$store.state.manager.clients.find(function(t){return t.id==e.ads_client}):null},addOrder:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i,s,r,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n={id:Object(ut["a"])(),order_field:(new Date).toISOString(),channel:e.channel,ads_client_channel:e.id},a=this.notify,i=this.channel,s=this.client,r=this.removeOrder,this.$store.state.manager.orders.push(n),o={model:n,modelName:"Order",callback:function(t){200!=t.status?(r(n),a("Уведомление!","Клиента «".concat(s(n).name,"» не удалось добавить в очередь канала «").concat(i.name,"»!"),"danger")):a("Уведомление!","Клиент «".concat(s(n).name,"» добавлен в очередь канала «").concat(i.name,"»!"),"success")}},t.next=9,this.postModel(o);case 9:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),removeOrder:function(t){this.$store.state.manager.orders=this.$store.state.manager.orders.filter(function(e){return e.id!=t.id})},notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},mn=hn,pn=Object(c["a"])(mn,un,dn,!1,null,"bfb51c38",null),fn=pn.exports,vn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},t._l(t.devices,function(e){return n("DeviceCard",{key:e.id,attrs:{device:e,clickCallback:t.addDevice}})}))},bn=[],gn={name:"AddDeviceModal",props:{channel:Object},components:{DeviceCard:ze},computed:{devices:function(){var t=this.$store.state.manager.channels?this.$store.state.manager.channels:[],e=this.$store.state.manager.devices?this.$store.state.manager.devices.filter(function(e){return void 0==t.find(function(t){return e.channel==t.id})}):[];return e.sort(function(t,e){return t.name.toLowerCase()>e.name.toLowerCase()?1:e.name.toLowerCase()>t.name.toLowerCase()?-1:0})}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel"])),{},{addDevice:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=this.notify,a=this.channel,e.channel=a.id,i={model:e,modelName:"DeviceState",callback:function(t){200!=t.status?(e.channel="00000000-0000-0000-0000-000000000000",n("Уведомление!","Приставку «".concat(e.name,"» не удалось подписать на канал «").concat(a.name,"»!"),"danger")):n("Уведомление!","Приставка «".concat(e.name,"» подписана на канал «").concat(a.name,"»!"),"success")}},t.next=6,this.postModel(i);case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},Cn=gn,_n=Object(c["a"])(Cn,vn,bn,!1,null,"4d9c1004",null),kn=_n.exports,wn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row pt-2 pb-2 pr-4 pl-4"},t._l(t.videos,function(e){return n("div",{key:e.src.id,staticClass:"col-md-4 p-1"},[n("ClientVideoCard",{attrs:{video:e.src,selected:e.selected,callback:t.changeSelect}})],1)}))},xn=[],yn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card p-2"},[n("b-form-checkbox",{on:{change:t.changed},model:{value:t.videoSelected,callback:function(e){t.videoSelected=e},expression:"videoSelected"}}),n("video",{staticClass:"img-fluid rounded",attrs:{controls:"",preload:"metadata"}},[n("source",{attrs:{src:"http://31.184.219.123:3666/video?video="+t.video.id}})])],1)},$n=[],On={name:"ClientVideoCard",props:{video:Object,selected:Boolean,callback:Function},data:function(){return{videoSelected:!1}},methods:{changed:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.callback(this.video,this.videoSelected);case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},created:function(){this.videoSelected=this.selected}},jn=On,Rn=Object(c["a"])(jn,yn,$n,!1,null,"43f11bc9",null),Tn=Rn.exports,Mn={name:"ClientChannelVideosModal",components:{ClientVideoCard:Tn},props:{clientChannel:Object},computed:{client:function(){var t=this;return this.$store.state.manager.clients?this.$store.state.manager.clients.find(function(e){return e.id==t.clientChannel.ads_client}):null},selectedVideos:function(){var t=this;return this.$store.state.manager.clientVideos?this.$store.state.manager.clientVideos.filter(function(e){return t.clientChannel.ads_videos.includes(e.id)}):[]},allVideos:function(){var t=this;return this.$store.state.manager.clientVideos?this.$store.state.manager.clientVideos.filter(function(e){return t.client.id==e.ads_client}):[]},videos:function(){var t=[],e=this.selectedVideos,n=this.allVideos;return n.forEach(function(n){var a={};a.src=n,a.selected=e.includes(n),t.push(a)}),t}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel"])),{},{changeSelect:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e,n){var a,i,s,r,o=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n?0==this.clientChannel.ads_videos.includes(e.id)&&this.clientChannel.ads_videos.push(e.id):this.clientChannel.ads_videos=this.clientChannel.ads_videos.filter(function(t){return t!=e.id}),a=this.notify,i=this.client,s=this.$store.state.manager.channels.find(function(t){return t.id==o.clientChannel.channel}),r={model:this.clientChannel,modelName:"ClientChannel",callback:function(t){200!=t.status?(r.model.ads_videos=r.model.ads_videos.filter(function(t){return t!=e.id}),a("Уведомление!",n?"Видеоролик клиента «".concat(i.name,"» не удалось добавить в канал «").concat(s.name,"»!"):"Видеоролик клиента «".concat(i.name,"» не удалось исключить из канала «").concat(s.name,"»!"),"danger")):a("Уведомление!",n?"Видеоролик клиента «".concat(i.name,"» добавлен в канал «").concat(s.name,"»!"):"Видеоролик клиента «".concat(i.name,"» исключен из канала «").concat(s.name,"»!"),"success")}},t.next=7,this.postModel(r);case 7:case"end":return t.stop()}},t,this)}));function e(e,n){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},Dn=Mn,Vn=Object(c["a"])(Dn,wn,xn,!1,null,"61a1c10f",null),Sn=Vn.exports,Nn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},[n("div",{staticClass:"d-flex align-items-center"},[1&t.device.info.DeviceStatus?n("b-icon",{attrs:{icon:"link45deg","font-scale":"3",variant:"danger"}}):n("b-icon",{attrs:{icon:"link45deg","font-scale":"3",variant:"success"}}),n("h4",[t._v(t._s(t.device.name))]),n("small",{staticClass:"text-muted ml-2"},[t._v("("+t._s(t.device.id)+")")])],1),t.device.address?n("p",{staticClass:"ml-2 mb-0"},[t._v("Адрес: "+t._s(t.device.address))]):t._e(),n("p",{staticClass:"ml-2 mb-0"},[t._v("Версия ПО: "+t._s(t.device.info.Version))]),n("p",{staticClass:"ml-2 mb-0"},[t._v("Свободного места: "+t._s(Math.round(t.device.info.FreeSpaceDisk/1024/1024/1024*100)/100)+" гбайт")]),n("p",{staticClass:"ml-2 mb-0"},[t._v("Альтернативный контент: "+t._s(t.device.info.ReadyVideosCount)+" видеороликов")]),t.clients.length?n("div",[n("p",{staticClass:"ml-2 mb-0"},[t._v("Клиенты:")]),n("ul",{staticClass:"ml-2 mb-0 mt-0"},t._l(t.clients,function(e){return n("li",{key:e.name},[t._v("«"+t._s(e.name)+"» скачано "+t._s(e.count)+" из "+t._s(e.all)+" видеороликов")])}))]):t._e(),-1!=t.device.info.DownloadType?n("div",[n("p",{staticClass:"ml-2 mb-0"},[t._v("Скачивание:")]),n("ul",{staticClass:"ml-2 mb-0 mt-0"},[0==t.device.info.DownloadType?n("li",[t._v("Логотип")]):t._e(),1==t.device.info.DownloadType?n("li",[t._v("Видеоролик клиента")]):t._e(),2==t.device.info.DownloadType?n("li",[t._v("Видеоролик альтернативного контента")]):t._e(),n("li",[t._v("Прогресс "+t._s(t.device.info.DownloadProgress)+"%")]),n("li",[t._v("Скорость "+t._s(Math.round(t.device.info.DownloadSpeed/1024*100)/100)+" кбайт/с")])])]):t._e(),n("div",{staticClass:"ml-2 mb-0"},[n("b-dropdown",{attrs:{text:"Выбор приоритетного клиента"}},[t._l(t.clients,function(e){return n("b-dropdown-item",{key:e.id,attrs:{active:t.device.tasks.priority==e.id},on:{click:function(n){t.setPriorityClient(e)}}},[n("p",{staticClass:"m-0 p-0"},[t._v(t._s(e.name))]),""!=e.description?n("p",{staticClass:"m-0 p-0 text-muted"},[t._v(t._s(e.description))]):t._e()])}),n("b-dropdown-divider"),n("b-dropdown-item",{attrs:{active:"00000000-0000-0000-0000-000000000000"==t.device.tasks.priority},on:{click:function(e){t.setPriorityClient({id:"00000000-0000-0000-0000-000000000000",name:"Без приоритета"})}}},[n("p",{staticClass:"m-0 p-0",class:"00000000-0000-0000-0000-000000000000"==t.device.tasks.priority?"":"text-muted"},[t._v("Без приоритета")])])],2)],1),n("div",{staticClass:"mb-0 mt-2"},[n("video",{staticClass:"rounded image-link",staticStyle:{"max-width":"100%"},attrs:{autoplay:"",loop:"",controls:"",muted:"",src:"http://31.184.219.123:3666/video?video="+t.device.info.CurrentVideo},domProps:{muted:!0}})]),"00000000-0000-0000-0000-000000000000"!=t.device.info.Screenshot?n("div",{staticClass:"mt-2"},[n("img",{staticClass:"rounded image-link",staticStyle:{"max-width":"100%"},attrs:{href:"http://31.184.219.123:4000/screenshot?screenshot="+t.device.info.Screenshot,src:"http://31.184.219.123:4000/screenshot?screenshot="+t.device.info.Screenshot}})]):t._e(),n("button",{staticClass:"btn btn-outline-primary mt-2 mb-2 float-right",attrs:{disabled:t.device.tasks.take_screenshot},on:{click:t.sendScreenshot}},[t._v("Сделать скриншот")])])},Ln=[],En={name:"FullDeviceModal",props:{device:Object},computed:{clients:function(){var t=this,e=[],n=this.$store.state.manager.clientChannels?this.$store.state.manager.clientChannels.filter(function(e){return e.channel==t.device.channel}):[],a=function(a){var i=n[a];e.push({id:i.id,name:t.$store.state.manager.clients?t.$store.state.manager.clients.find(function(t){return t.id==i.ads_client}).name:"",count:t.device.info.ClientVideos&&t.device.info.ClientVideos[i.id]?t.device.info.ClientVideos[i.id]:0,all:t.$store.state.manager.clientVideos?t.$store.state.manager.clientVideos.filter(function(t){return i.ads_videos.includes(t.id)}).length:0})};for(var i in n)a(i);return e}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel"])),{},{sendScreenshot:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.device.tasks,e.take_screenshot=!0,n={model:e,modelName:"DeviceTasks",callback:function(t){}},t.next=5,this.postModel(n);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setPriorityClient:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=this.notify,a=this.device.tasks,a.priority=e.id,i={model:a,modelName:"DeviceTasks",callback:function(t){200==t.status?setTimeout(function(){return n("Уведомление!","Приоритетный клиент «".concat(e.name,"» установлен!"),"success")},0):setTimeout(function(){return n("Уведомление!","Приоритетный клиент «".concat(e.name,"» не установлен!"),"danger")},0)}},t.next=6,this.postModel(i);case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},Fn=En,Un=Object(c["a"])(Fn,Nn,Ln,!1,null,"155b95d3",null),An=Un.exports,Pn={name:"Channel",components:{ContentCard:Z,ClientChannelCard:Ve,OrderCard:Ue,DeviceCard:ze},props:{channel:Object,editCallback:Function,deleteCallback:Function},computed:{user:function(){var t=this;return this.$store.state.manager.users?this.$store.state.manager.users.find(function(e){return e.id==t.channel.account}):null},red:function(){var t=this.user;return t?t.red:255},green:function(){var t=this.user;return t?t.green:255},blue:function(){var t=this.user;return t?t.blue:255},tickerInterval:function(){return this.msToMinutes(this.channel.ticker_interval/1e4)},reloadTime:function(){return this.msToTime(this.channel.reload_time/1e4)},contents:function(){var t=this;return this.$store.state.manager.contents?this.$store.state.manager.contents.filter(function(e){return t.channel.contents.includes(e.id)}):[]},clientChannels:function(){var t=this;return this.$store.state.manager.clientChannels?this.$store.state.manager.clientChannels.filter(function(e){return e.channel==t.channel.id}):[]},orders:function(){var t=this,e=this.$store.state.manager.orders?this.$store.state.manager.orders.filter(function(e){return e.channel==t.channel.id}):[];return e.sort(function(t,e){return t.order_field>e.order_field?1:e.order_field>t.order_field?-1:0})},devices:function(){var t=this,e=this.$store.state.manager.devices?this.$store.state.manager.devices.filter(function(e){return e.channel==t.channel.id}):[];return e.sort(function(t,e){return t.name.toLowerCase()>e.name.toLowerCase()?1:e.name.toLowerCase()>t.name.toLowerCase()?-1:0})}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel","deleteModel"])),{},{msToMinutes:function(t){var e=t%1e3;t=(t-e)/1e3;var n=t%60;return t=(t-n)/60,t},msToTime:function(t){var e=t%1e3;t=(t-e)/1e3;var n=t%60;t=(t-n)/60;var a=t%60,i=(t-a)/60;return this.timeFormat(i)+":"+this.timeFormat(a)},timeFormat:function(t){return t<10?"0".concat(t):t},showAddContentModal:function(){this.$modal.show(nn,{channel:this.channel},{height:"auto",width:"80%",scrollable:!0})},showAddClientModal:function(){this.$modal.show(ln,{channel:this.channel},{height:"auto",width:"80%",scrollable:!0})},showAddOrderModal:function(){this.$modal.show(fn,{channel:this.channel},{height:"auto",width:"80%",scrollable:!0})},showAddDeviceModal:function(){this.$modal.show(kn,{channel:this.channel},{height:"auto",width:"80%",scrollable:!0})},contentClicked:function(t){this.$modal.show(gt,{content:t},{height:"auto",width:"80%",scrollable:!0})},showClientChannelVideosModal:function(t){this.$modal.show(Sn,{clientChannel:t},{height:"auto",width:"80%",scrollable:!0})},editClientChannel:function(t){this.$modal.show(Qe,{clientChannel:t},{height:"auto",width:"60%",scrollable:!0})},showFullDeviceInfo:function(t){this.$modal.show(An,{device:t},{height:"auto",width:"60%",scrollable:!0})},deleteContent:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this.channel,a=this.notify,this.$modal.show("dialog",{title:"Подтвердите действие",text:"Исключить альтернативный контент «".concat(e.name,"» из канала «").concat(n.name,"»?"),buttons:[{title:"Да",handler:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(i.$modal.hide("dialog"),!n.contents.includes(e.id)){t.next=6;break}return n.contents=n.contents.filter(function(t){return t!=e.id}),s={model:n,modelName:"Channel",callback:function(t){200!=t.status?(n.contents.push(e.id),a("Уведомление!","Альтернативный контент «".concat(e.name,"» не удалось исключить из канала «").concat(n.name,"»!"),"danger")):a("Уведомление!","Альтернативный контент «".concat(e.name,"» исключен из канала «").concat(n.name,"»!"),"success")}},t.next=6,i.postModel(s);case 6:case"end":return t.stop()}},t)}));function s(){return t.apply(this,arguments)}return s}()},{title:"Нет",handler:function(){i.$modal.hide("dialog")}}]});case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),returnClientChannel:function(t){this.$store.state.manager.clientChannels.push(t)},removeClientChannel:function(t){this.$store.state.manager.clientChannels=this.$store.state.manager.clientChannels.filter(function(e){return e.id!=t.id})},deleteClientChannel:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i,s,r,o=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this.channel,a=this.notify,i=this.$store.state.manager.clients.find(function(t){return t.id==e.ads_client}),s=this.removeClientChannel,r=this.returnClientChannel,this.$modal.show("dialog",{title:"Подтвердите действие",text:"Исключить клиента «".concat(i.name,"» из канала «").concat(n.name,"»?"),buttons:[{title:"Да",handler:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var c;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return o.$modal.hide("dialog"),s(e),c={model:e,modelName:"ClientChannel",callback:function(t){200!=t.status?(r(e),a("Уведомление!","Клиента «".concat(i.name,"» не удалось исключить из канала «").concat(n.name,"»!"),"danger")):a("Уведомление!","Клиент «".concat(i.name,"» исключен из канала «").concat(n.name,"»!"),"success")}},t.next=5,o.deleteModel(c);case 5:case"end":return t.stop()}},t)}));function c(){return t.apply(this,arguments)}return c}()},{title:"Нет",handler:function(){o.$modal.hide("dialog")}}]});case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),returnOrder:function(t){this.$store.state.manager.orders.push(t)},removeOrder:function(t){this.$store.state.manager.orders=this.$store.state.manager.orders.filter(function(e){return e.id!=t.id})},deleteOrder:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i,s,r,o,c=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this.channel,a=this.notify,i=this.$store.state.manager.clientChannels.find(function(t){return t.id==e.ads_client_channel}),s=this.$store.state.manager.clients.find(function(t){return t.id==i.ads_client}),r=this.removeOrder,o=this.returnOrder,this.$modal.show("dialog",{title:"Подтвердите действие",text:"Исключить запись клиента «".concat(s.name,"» из очереди канала «").concat(n.name,"»?"),buttons:[{title:"Да",handler:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return c.$modal.hide("dialog"),r(e),i={model:e,modelName:"Order",callback:function(t){200!=t.status?(o(e),a("Уведомление!","Запись клиента «".concat(s.name,"» не удалось исключить из очереди канала «").concat(n.name,"»!"),"danger")):a("Уведомление!","Запись клиента «".concat(s.name,"» исключена из очереди канала «").concat(n.name,"»!"),"success")}},t.next=5,c.deleteModel(i);case 5:case"end":return t.stop()}},t)}));function i(){return t.apply(this,arguments)}return i}()},{title:"Нет",handler:function(){c.$modal.hide("dialog")}}]});case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),removeDevice:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this.channel,a=this.notify,this.$modal.show("dialog",{title:"Подтвердите действие",text:"Отписать приставку «".concat(e.name,"» от канала «").concat(n.name,"»?"),buttons:[{title:"Да",handler:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i.$modal.hide("dialog"),e.channel="00000000-0000-0000-0000-000000000000",s={model:e,modelName:"DeviceState",callback:function(t){200!=t.status?(e.channel=n.id,a("Уведомление!","Приставку «".concat(e.name,"» не удалось отписать от канала «").concat(n.name,"»!"),"danger")):a("Уведомление!","Приставка «".concat(e.name,"» отписана от канала «").concat(n.name,"»!"),"success")}},t.next=5,i.postModel(s);case 5:case"end":return t.stop()}},t)}));function s(){return t.apply(this,arguments)}return s}()},{title:"Нет",handler:function(){i.$modal.hide("dialog")}}]});case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}})},In=Pn,Hn=Object(c["a"])(In,$e,Oe,!1,null,"0f519ade",null),Yn=Hn.exports,zn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-2 pb-2 pr-4 pl-4"},[n("div",{staticClass:"input-group mb-3 mt-3"},[t._m(0),n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{disabled:t.saving,type:"text",placeholder:"..."},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),n("div",{staticClass:"input-group mb-3"},[t._m(1),n("input",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"form-control",attrs:{disabled:t.saving,type:"text",placeholder:"..."},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}})]),n("div",{staticClass:"input-group"},[t._m(2),n("input",{ref:"left",staticClass:"form-control",attrs:{disabled:t.saving,type:"file",accept:"image/*"},on:{change:t.logoLeft}})]),n("div",{staticClass:"align-items-center mb-3"},["00000000-0000-0000-0000-000000000000"!=t.logo_left?n("div",[n("button",{staticClass:"close float-right",attrs:{disabled:t.saving,type:"button"},on:{click:t.logoLeft}},[n("b-icon-x",{attrs:{variant:"danger"}})],1),n("p",{staticClass:"text-muted float-right"},[t._v("Выбрано: "+t._s(t.logo_left))])]):t._e()]),n("div",{staticClass:"input-group mb-3"},[t._m(3),n("input",{ref:"right",staticClass:"form-control",attrs:{disabled:t.saving,type:"file",accept:"image/*"},on:{change:t.logoRight}})]),n("div",{staticClass:"align-items-center mb-3"},["00000000-0000-0000-0000-000000000000"!=t.logo_right?n("div",[n("button",{staticClass:"close float-right",attrs:{disabled:t.saving,type:"button"},on:{click:t.logoRight}},[n("b-icon-x",{attrs:{variant:"danger"}})],1),n("p",{staticClass:"text-muted float-right"},[t._v("Выбрано: "+t._s(t.logo_right))])]):t._e()]),n("div",{staticClass:"input-group mb-3"},[t._m(4),n("input",{directives:[{name:"model",rawName:"v-model",value:t.ticker,expression:"ticker"}],staticClass:"form-control",attrs:{disabled:t.saving,type:"text",placeholder:"..."},domProps:{value:t.ticker},on:{input:function(e){e.target.composing||(t.ticker=e.target.value)}}})]),n("div",{staticClass:"input-group mb-3"},[t._m(5),n("input",{ref:"ticker",staticClass:"form-control",attrs:{disabled:t.saving,type:"time"},on:{change:t.tickerIntervalChanged}})]),n("div",{staticClass:"input-group mb-3"},[t._m(6),n("input",{ref:"reload",staticClass:"form-control",attrs:{disabled:t.saving,type:"time"},on:{change:t.reloadTimeChanged}})]),n("div",{staticClass:"input-group mb-3"},[t._m(7),n("b-form-select",{attrs:{disabled:t.saving,options:t.orientations},model:{value:t.orientation,callback:function(e){t.orientation=e},expression:"orientation"}})],1),n("button",{staticClass:"btn btn-primary float-right mb-3",attrs:{disabled:t.saving,type:"submit"},on:{click:t.save}},[t._v("Сохранить")])])},Bn=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Название")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Описание")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Логотип слева")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Логотип справа")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Бегущая строка")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Интервал бегущей строки")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Время перезагрузки")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("Ориентация экрана")])])}],Jn={name:"ChannelForm",props:{channel:Object},data:function(){return{id:Object(ut["a"])(),founder:this.$store.getters.StateUser.username,name:"",description:"",logo_left:"00000000-0000-0000-0000-000000000000",logo_right:"00000000-0000-0000-0000-000000000000",ticker:"",ticker_interval:0,reload_time:0,orientation:0,account:this.$store.getters.StateUser.id,workers:[],contents:[],saving:!1,orientations:[{value:0,text:"Горизонтальная"},{value:1,text:"Вертикальная"}]}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["postModel","uploadLogo"])),{},{logoLeft:function(){this.logo_left="00000000-0000-0000-0000-000000000000"},logoRight:function(){this.logo_right="00000000-0000-0000-0000-000000000000"},tickerIntervalChanged:function(t){this.ticker_interval=1e4*t.target.valueAsNumber},reloadTimeChanged:function(t){this.reload_time=1e4*t.target.valueAsNumber},save:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e,n,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,this.saving=!0,!this.$refs.left.files.length){t.next=5;break}return t.next=5,this.uploadLeftLogo();case 5:if(!this.$refs.right.files.length){t.next=8;break}return t.next=8,this.uploadRightLogo();case 8:return e={id:this.id,founder:this.founder,name:this.name,description:this.description,logo_left:this.logo_left,logo_right:this.logo_right,ticker:this.ticker,ticker_interval:this.ticker_interval,reload_time:this.reload_time,orientation:this.orientation,account:this.account,workers:this.workers,contents:this.contents},n=this,a=this.notify,i={model:e,modelName:"Channel",callback:function(t){200!=t.status?a("Уведомление!","Канал «".concat(e.name,"» не удалось сохранить!"),"danger"):(n.$emit("close"),setTimeout(function(){return a("Уведомление!","Канал «".concat(e.name,"» сохранен!"),"success")},0))}},t.next=14,this.postModel(i);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](0),notify("Уведомление!","Что-то пошло не так...","danger");case 19:return t.prev=19,this.saving=!1,t.finish(19);case 22:case"end":return t.stop()}},t,this,[[0,16,19,22]])}));function e(){return t.apply(this,arguments)}return e}(),uploadLeftLogo:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,n={logo:this.$refs.left.files[0],callback:function(t){200==t.status&&(e.logo_left=t.data.file)}},t.next=4,this.uploadLogo(n);case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),uploadRightLogo:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,n={logo:this.$refs.right.files[0],callback:function(t){200==t.status&&(e.logo_right=t.data.file)}},t.next=4,this.uploadLogo(n);case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}}),created:function(){this.channel&&(this.id=this.channel.id,this.founder=this.channel.founder,this.name=this.channel.name,this.description=this.channel.description,this.logo_left=this.channel.logo_left,this.logo_right=this.channel.logo_right,this.ticker=this.channel.ticker,this.ticker_interval=this.channel.ticker_interval,this.reload_time=this.channel.reload_time,this.orientation=this.channel.orientation,this.account=this.channel.account,this.workers=this.channel.workers,this.contents=this.channel.contents)},mounted:function(){this.$refs.ticker.valueAsNumber=this.ticker_interval/1e4,this.$refs.reload.valueAsNumber=this.reload_time/1e4}},qn=Jn,Gn=Object(c["a"])(qn,zn,Bn,!1,null,"1466db63",null),Kn=Gn.exports,Qn={name:"Home",components:{ControlPanel:Y,AccountPanel:ne,InformationPanel:ye,ChannelCard:Yn},computed:{channels:function(){var t=this.$store.state.manager.channels?this.$store.state.manager.channels:[];return t.sort(function(t,e){return t.name.toLowerCase()>e.name.toLowerCase()?1:e.name.toLowerCase()>t.name.toLowerCase()?-1:0})}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["getModels","deleteModel","clearModels","connectToNotifyService"])),{},{addChannel:function(){this.$modal.show(Kn,{channel:null},{height:"auto",width:"60%",scrollable:!0})},editChannel:function(t){this.$modal.show(Kn,{channel:t},{height:"auto",width:"60%",scrollable:!0})},deleteChannel:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(e){var n,a,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this,a=this.notify,this.$modal.show("dialog",{title:"Подтвердите действие",text:"Удалить канал «".concat(e.name,"»?"),buttons:[{title:"Да",handler:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i.$modal.hide("dialog"),i.$store.state.manager.channels=i.$store.state.manager.channels.filter(function(t){return t.id!=e.id}),s={model:e,modelName:"Channel",callback:function(t){200!=t.status?(n.$store.state.manager.channels.push(e),a("Уведомление!","Канал «".concat(e.name,"» не удалось удалить!"),"danger")):a("Уведомление!","Канал «".concat(e.name,"» удален!"),"success")}},t.next=5,i.deleteModel(s);case 5:case"end":return t.stop()}},t)}));function s(){return t.apply(this,arguments)}return s}()},{title:"Нет",handler:function(){i.$modal.hide("dialog")}}]});case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),notify:function(t,e,n){this.$bvToast.toast(e,{title:t,autoHideDelay:5e3,toaster:"b-toaster-top-center",variant:n,appendToast:!1})}}),created:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.getModels("AdvertisingClient"),this.getModels("AdvertisingVideo"),this.getModels("Channel"),this.getModels("ClientChannel"),this.getModels("Content"),this.getModels("ContentVideo"),this.getModels("Order"),this.getModels("User"),this.getModels("DeviceState"),this.connectToNotifyService(),setTimeout(function(){console.log(e.$store.state.manager.devices)},5e3);case 11:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),beforeDestroy:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.clearModels();case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},Wn=Qn,Xn=(n("741b"),Object(c["a"])(Wn,L,E,!1,null,"0bcae7da",null)),Zn=Xn.exports,ta=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login"},[n("div",{staticClass:"flip-card"},[n("div",{staticClass:"flip-card-inner"},[n("div",{staticClass:"flip-card-front"},[n("div",{staticClass:"signin-form"},[n("form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[n("h1",[t._v("Вход")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.username,expression:"form.username"}],staticClass:"txtb mt-4",attrs:{name:"username",disabled:t.loading,type:"text",placeholder:"Логин"},domProps:{value:t.form.username},on:{input:function(e){e.target.composing||t.$set(t.form,"username",e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"txtb mt-4",attrs:{name:"password",disabled:t.loading,type:"password",placeholder:"Пароль"},domProps:{value:t.form.password},on:{input:function(e){e.target.composing||t.$set(t.form,"password",e.target.value)}}}),n("input",{staticClass:"signin-btn mt-4 mb-2",attrs:{disabled:t.loading,type:"submit",value:"Войти"}}),t.loading?n("div",{staticClass:"d-flex justify-content-center"},[t._m(0)]):t._e(),t.showError?n("h4",{staticClass:"text-danger mt-3"},[t._v("Введены неверные данные!")]):t._e()])])])])]),n("div",{staticClass:"shadow"})])},ea=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"spinner-border text-primary mt-3",attrs:{role:"status"}},[n("span",{staticClass:"sr-only"},[t._v("Загрузка...")])])}],na={name:"Login",data:function(){return{form:{username:"",password:""},loading:!1,showError:!1}},methods:Object(F["a"])(Object(F["a"])({},Object(h["b"])(["LogIn"])),{},{submit:function(){var t=Object(p["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,this.showError=!1,e=new FormData,e.append("username",this.form.username),e.append("password",this.form.password),t.next=8,this.LogIn(e);case 8:this.$router.push("/"),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),this.showError=!0;case 14:return t.prev=14,this.loading=!1,t.finish(14);case 17:case"end":return t.stop()}},t,this,[[0,11,14,17]])}));function e(){return t.apply(this,arguments)}return e}()})},aa=na,ia=(n("0ae9"),Object(c["a"])(aa,ta,ea,!1,null,"3715a2f2",null)),sa=ia.exports;a["default"].use(d["a"]);var ra=[{path:"/",name:"Home",component:Zn,meta:{requiresAuth:!0,title:"ShowingAds | Панель управления"}},{path:"/login",name:"Login",component:sa,meta:{guest:!0,title:"ShowingAds | Авторизация"}}],oa=new d["a"]({mode:"history",base:"/",routes:ra});oa.beforeEach(function(t,e,n){if(document.title=t.meta.title,t.matched.some(function(t){return t.meta.requiresAuth})){if(N.getters.isAuthenticated)return void n();n("/login")}else n()});var ca=oa,la=n("1881"),ua=n.n(la),da=n("ee98"),ha=n.n(da),ma=n("5f5b"),pa=n("b1e0");n("f9e3"),n("2dd8");v.a.interceptors.response.use(void 0,function(t){if(t){var e=t.config;if(401===t.response.status&&!e._retry)return e._retry=!0,N.dispatch("LogOut"),ca.push("/login")}}),a["default"].use(ua.a,{dialog:!0}),a["default"].use(ha.a),a["default"].use(ma["a"]),a["default"].use(pa["a"]),a["default"].config.productionTip=!0,new a["default"]({store:N,router:ca,render:function(t){return t(u)}}).$mount("#app")},"741b":function(t,e,n){"use strict";n("ac9a")},ac9a:function(t,e,n){},b58d:function(t,e,n){},c21b:function(t,e,n){},dcb2:function(t,e,n){}});
//# sourceMappingURL=app.8051f589.js.map